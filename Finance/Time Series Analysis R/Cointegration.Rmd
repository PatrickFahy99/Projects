# Creating a random walk
set.seed(123)
z <- rep(0, 1000)
for (i in 2:1000) z[i] <- z[i-1] + rnorm(1)
plot(z, type="l")

layout(1:2)
acf(z)
acf(diff(z))

# Create two new series derived from z
x <- y <- rep(0, 1000)
x <- 0.3*z + rnorm(1000)
y <- 0.6*z + rnorm(1000)
plot(x, type="l")
plot(y, type="l")

comb <- 2*x - y
plot(comb, type="l")
acf(comb)
# Looks stationary!

# Let's use the Augmented Dickey Fuller test on comb:
library("tseries")
adf.test(comb)
# p-val is very small, so when have necessary information to reject the null hypothesis that the series possesses a unit root (i.e is not stationary)

# Now Phillips-Perron test:
pp.test(comb)
# Yeet, same outcome

# Now the Phillips-Ouliaris test:
po.test(cbind(2*x,-1.0*y))
# Yeet again

# Now try the same for a bad combination of x and y:

badcomb <- -1.0*x + 2.0*y
plot(badcomb, type="l")
acf(diff(badcomb))
adf.test(badcomb)
# p-val is 0.39 so way above 0.05 so cant reject null hypothesis