# MA(1)

set.seed(1)
x <- w <- rnorm(100)
for (t in 2:100) x[t] <- w[t] + 0.6*w[t-1]
layout(1:2)
plot(x, type="l")
acf(x)

x.ma <- arima(x, order=c(0, 0, 1))
x.ma

0.6023 + c(-1.96, 1.96)*0.0827

set.seed(1)
x <- w <- rnorm(100)
for (t in 2:100) x[t] <- w[t] - 0.6*w[t-1]
layout(1:2)
plot(x, type="l")
acf(x)

x.ma <- arima(x, order=c(0, 0, 1))
x.ma

-0.730 + c(-1.96, 1.96)*0.1008

# MA(3)

set.seed(3)
x <- w <- rnorm(1000)
for (t in 4:1000) x[t] <- w[t] + 0.6*w[t-1] + 0.4*w[t-2] + 0.3*w[t-3]
layout(1:2)
plot(x, type="l")
acf(x)

x.ma <- arima(x, order=c(0, 0, 3))
x.ma

0.544 + c(-1.96, 1.96)*0.0309
0.345 + c(-1.96, 1.96)*0.0349
0.298 + c(-1.96, 1.96)*0.0311

# Financial Data

require(quantmod)
getSymbols("AMZN")
amznrt = diff(log(Cl(AMZN)))

amznrt.ma <- arima(amznrt, order=c(0, 0, 1))
amznrt.ma

layout(1:1)

acf(amznrt.ma$res[-1])

# Notice that we have a few significant peaks at lags k = 2, k = 11, k = 16 and k = 18,
# indicating that the MA(1) model is unlikely to be a good fit for the behaviour of the AMZN log
# returns, since this does not look like a realisation of white noise.

# Now try MA(2):
amznrt.ma <- arima(amznrt, order=c(0, 0, 2))
amznrt.ma

acf(amznrt.ma$res[-1])

amznrt.ma <- arima(amznrt, order=c(0, 0, 3))

amznrt.ma

acf(amznrt.ma$res[-1])




getSymbols("^GSPC")
gspcrt = diff(log(Cl(GSPC)))

gspcrt.ma <- arima(gspcrt, order=c(0, 0, 1))
gspcrt.ma

acf(gspcrt.ma$res[-1])

gspcrt.ma <- arima(gspcrt, order=c(0, 0, 2))
gspcrt.ma

acf(gspcrt.ma$res[-1])


